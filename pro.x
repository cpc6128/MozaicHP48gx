HPHP48-R,*pš%#####################
%#MOZAIC~GESTIONNAIRE#
%#   D'ICONE V2.0    #
%#####################
% LISTING  ASSEMBLEUR
%      ECRIT PAR
%    MOUNES  RONAN
%  DEBUT : MARS 1996
%  FIN   : ?
% (P)1996  DIMENSSION
GOTO PRESENTATION
$A002D4F4A5149434E77454354594F4E4E414942554A00202020244729434F4E45402026523E203A002C494354594E474020214353554D424C4545525A0020202020202543425944502051425A002020202D4F455E45435020225F4E414E4A00202445424554502A302D41425350213939363A002026494E4020202A302F3A0028205921393936302024494D454E4353594F4E4A0


*PRESENTATION
GOSBVL 0679B
GOSBVL 01115
ST=0 4
ST=0 5
ST=0 6
ST=0 7
ST=0 1
ST=0 2
ST=0 3
ST=0 0
A=DAT1 A
A=A+10 A
D0= 80400
DAT0=A A
GOSUBL APRES.ICONE
/LISTICO


*APRES.ICONE
C=RSTK
D0= 80405
DAT0=C A
LC 01201
GOSBVL 05B7D
A=R0 A
AD0EX
A=A+1 A
ABIT=0 0
R0=A A
%CONSERVE LES COORD.
A=0 A
LA 3D
R1=A A
R3=A A
LA 20
R2=A A
R4=A A


*SALUT.A.TOI
C=R1 A
D0= 80420
DAT0=C A
D0=D0+ 5
C=R3 A
DAT0=C A
D0=D0+ 5
C=R2 A
DAT0=C A
D0=D0+ 5
C=R4 A
DAT0=C A
D0= 00120
A=R0 A
DAT0=A A
B=0 S
P= 0
LC B
P=C 0
C=P 15
D=C S
P= 0
GOSUBL APRES.ECRAN
/ECRAN


*APRES.ECRAN
C=RSTK
D0=C
C=R0 A
D1=C
LC 01200
GOSBVL 0670C
D0= 80400
A=DAT0 A
LC 00200
C=C+A A
D1=C
C=DAT1 3
R2=C X
?C‹0 X
GOYES CON3
GOTO CON


*CON3
A=R0 A
B=A A
LA 00243
B=B+A A
GOSUB PATH
GOTO AP.PATH


*PATH
D0= 80400
A=DAT0 A
D0=A
A=0 A
A=DAT0 B
CD0EX
A=A+A A
A=A+C A
D0=A
A=0 A
A=DAT0 B
D0=C
RTN%
%_____________________


*AP.PATH
R4=A A
GOSUBL VSYNC
D1= 00120
LC 00880
A=R0 A
C=C+A A
DAT1=C A
AD0EX
LC 00205
A=A+C A
D1=A


*BCL.PRINC
A=R2 X
A=A-1 X
GONC FARID
GOTO CON


*FARID
R2=A X
A=DAT1 B
C=R4 A
?A=C B
GOYES TU.AFF
AD1EX
LC 0006C
A=A+C A
D1=A
GOTO BCL.PRINC


*TU.AFF
D1=D1+ 4
CD1EX
R1=C A
D1=C
C=DAT1 A
D1= 80405
A=DAT1 A
C=C+A A
D1=C
%PREMIER AFFICHAGE
C=B A
D0=C
LC 09
D=C A
GOSUB AFF.I
C=B A
LA 00880
C=C+A A
D0=C
LC 09
D=C A
GOSUB AFF.I
%DEUXIEME AFFICHAGE
C=R1 A
C=C+5 A
D1=C
LC 00154
B=B+C A
C=B A
D0=C
LC 0B
D=C A
GOSUB AFF.I
C=B A
LA 00880
C=C+A A
D0=C
LC 0B
D=C A
GOSUB AFF.I
LC 00154
B=B-C A
C=B A
GOTO SUITE1


*AFF.I


*BCL1
C=DAT1 4
DAT0=C 4
D1=D1+ 4
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D=D-1 B
GONC BCL1
RTN%
%_____________________


*SUITE1
LC 5
P=C 0
C=P 15
?C‹B S
GOYES OK
P= 0
A=R0 A
B=A A
LA 00551
B=B+A A
GOTO CONT1


*OK
P= 0
B=B+5 A


*CONT1
B=B+1 S
D=D-1 S
GONC ERREUR
GOTO CON


*ERREUR
D1=D1+ 3
GOTO BCL.PRINC


*CON
ST=0 2
ST=0 3
A=B S
R3=A S
GOSBVL 42359
D1= 00128
LC 3F
DAT1=C B
%DEBUT VAR
D0= 80420
C=DAT0 A
R1=C A
D0=D0+ 5
C=DAT0 A
R3=C A
D0=D0+ 5
C=DAT0 A
R2=C A
D0=D0+ 5
C=DAT0 A
R4=C A
%FIN.VAR
GOSUBL AFFICHE
ST=0 0
D0= 8040F
LC 00005
DAT0=C A
D0= 80414
LC 005A0
DAT0=C A


*BOUCLE
ST=0 1
D0= 00120
C=R0 A
DAT0=C A
LC 010
GOSBVL 01EEC
?CBIT=1 4
GOYES CHIER
GOTO DEMO


*CHIER
?ST=0 6
GOYES PAS.ATTENTE
GOLONG FIN.ATTENTE


*PAS.ATTENTE
GOSBVL 01BEB
ST=1 0
?ST=0 2
GOYES OPTION?
GOLONG SUITE.BOXMOZ


*OPTION?
?ST=0 3
GOYES DEMO
GOLONG SUITE.OPTION


*DEMO
%ON.REGARDE.SI.IC.SUPP
?ST=0 4
GOYES ON.AVANCE
GOSUBL AFFICHE
LA 0F
C=R2 A
?C‰A A
GOYES ON.SUP.T2
ST=1 5
GOTO SUITE.T2


*ON.SUP.T2
ST=0 5


*SUITE.T2
GOSUBL AFFICHE


*ON.AVANCE
C=0 A
C=C+1 A
A=R1 A
B=A A
A=0 A
A=A+16 A
A=A+4 A
?A>B A
GOYES TSTOK
C=C+1 A
A=A+16 A
A=A+4 A
?A>B A
GOYES TSTOK
C=C+1 A
A=A+16 A
A=A+4 A
?A>B A
GOYES TSTOK
C=C+1 A
A=A+16 A
A=A+4 A
?A>B A
GOYES TSTOK
C=C+1 A
A=A+16 A
A=A+4 A
?A>B A
GOYES TSTOK
C=C+1 A
A=A+16 A
A=A+5 A
?A>B A
GOYES TSTOK
LC 000C8


*TSTOK
C=C+1 A
D=0 A
D=D+6 A
A=R2 A
B=A A
A=0 A
LA 28
?A<B A
GOYES TSTOKK
LA 11
D=0 A
?A<B A
GOYES TSTOKK
A=A-3 A
D=D+16 A
D=D+4 A
?A<B A
GOYES TSTOKK
A=A-6 A
D=D+16 A
D=D+4 A
?A<B A
GOYES TSTOKK
D=D+10 A


*TSTOKK
C=C+D A
B=C A
LA 34
?C‹A B
GOYES IFI
A=R1 A
LC 0000A
?A‰C A
GOYES ERR


*IFI
C=B A
LA 39
?C‹A B
GOYES FIFI2
C=R1 A
LA 6F
?AŠC B
GOYES FIFIFI
GOTO PAS.DROP


*FIFIFI
B=A A


*FIFI2
C=B A
LA FB
?C‹A B
GOYES PAS.DE.UP
GOTO PAS.DROP


*PAS.DE.UP
C=B A
LA 0D
?C>A B
GOYES MERDE2
P=C 0
P=P-1
C=P 15
P= 0
A=R3 S
?C>A S
GOYES MERDE2
?ST=1 0
GOYES PAS.
GOTO PAS.DROP


*MERDE2
GOTO PAS.DROP


*ERR
?ST=0 0
GOYES MERDE2
C=B A
R1=C A
GOTO C.EST.RIEN


*PLUS.BAS
C=D A
D0=C
C=DAT0 B
GOLONG REPERTOIRE


*PAS.
%ON VERIFIE ETAT ICONE
GOSUBL GO.TO.ICONE
D0=D0+ 2
CD0EX
D0=C
D=C A
%C=0 A
C=DAT0 B
LA FF
?A‹C B
GOYES PAS.OK.PROG
GOTO OK.PROG


*PAS.OK.PROG
?ST=0 4
GOYES PLUS.BAS
GOSUBL TEST.SI.REP.VIDE
ST=1 1
C=D A
D0=C
C=DAT0 B
?A=B B
GOYES ROUTINE.REP.FULL
GOTO OK.PROG


*ROUTINE.REP.FULL
GOSUB AFFICHE
GOSUB APRES.REPERTOIRE
/REPERTOIRE


*APRES.REPERTOIRE
C=RSTK
D1=C
C=R0 A
LA 00318
C=C+A A
D0=C
LA 12
P= 11
GOSUBL AFF.SPRITE
C=R0 A
LA 00318
C=C+A A
LA 00880
C=C+A A
D0=C
LA 12
P= 11
GOSUBL AFF.SPRITE
GOSUBL PAS.TOUCHE
GOSUB AFFICHE
GOSUBL SI.TOUCHE
GOSUBL PAS.TOUCHE
GOLONG SALUT.A.TOI


*OK.PROG
%ON.VERIFIE.SI.SUPP.IC
LA 00067
CD0EX
C=C+A A
D0=C
C=0 A
C=DAT0 3
R1=C A
C=D A
D0=C
%FIN VERIFICATION
?ST=1 4
GOYES ON.TE.SUPP


*C.EST.RIEN
D=0 A
GOTO FIFI


*ON.TE.SUPP
CD0EX
C=C-2 A
B=C A
D0= 80400
C=DAT0 A
C=C-5 A
D0=C
A=DAT0 A
C=C+A A
LA 0006C
C=C-A A
C=C-B A
A=A+B A
D0=A
A=B A
D1=A
GOSBVL 0670C%ON COPIE
D0= 80400
C=DAT0 A
C=C-5 A
D0=C
C=DAT0 A
LA 0006C
C=C-A A
DAT0=C A
CD0EX
LA 00205
C=C+A A
D0=C
C=DAT0 X
C=C-1 X
DAT0=C X
?ST=1 1
GOYES TEST.REP.OK
LC 10000
D=C A
GOTO TEST.REP.FIN


*TEST.REP.OK
D0= 80400
C=DAT0 A
LA 00203
C=C+A A
D0=C
C=DAT0 A
C=C-1 A
DAT0=C A
GOSUBL PAS.TOUCHE
GOLONG SALUT.A.TOI


*TEST.REP.FIN


*FIFI
LC 10000
?C‹D A
GOYES PAS.NUMERO
GOSUBL ROUT.NUMERO.LISTE
*PAS.NUMERO
C=R1 A
C=C+D A
R1=C A
GOSUB PAS.TOUCHE
GOSBVL 01C7F
GOSBVL 067D2
GOSBVL 010E5
C=DAT1 A
?C=0 A
GOYES FIN
D1=D1+ 5
D=D+1 A
GOSBVL 0679B
GOSBVL 067D2


*FIN
A=R1 A
GOSBVL 0357C


*PAS.DROP
?ST=0 0
GOYES TEST.ANNUL.T2
ST=0 4
?ST=0 5
GOYES C.EST.BON
GOSUB AFFICHE
ST=0 5
GOSUB AFFICHE


*C.EST.BON


*TEST.ANNUL.T2
D0= 0010B
C=DAT0 1
CBIT=0 1
LA FB
?A‹B B
GOYES PAS.INDI
CBIT=1 1


*PAS.INDI
DAT0=C 1
D0= 0010B
C=DAT0 1
CBIT=0 0
LA 39
?A‹B B
GOYES PAS.INDI2
CBIT=1 0


*PAS.INDI2
DAT0=C 1
?ST=0 0
GOYES PAS.OFF


*IC.OPTION
LC 2A
?C‹B B
GOYES CONTRASTE2


*OKOK
D0= 8040A
C=0 A
DAT0=C A
GOSUBL OPTION
GOTO PAS.OFF


*CONTRASTE2
LC 2B
?C‹B B
GOYES PAS.OFF
GOTO OKOK


*PAS.OFF
?ST=0 0
GOYES PAS.OFF3


*UP.TEST
LC 39
?C‹B B
GOYES PAS.OFF2
D0= 80400
A=DAT0 A
D0=A
A=0 B
A=A+1 B
DAT0=A B
GOSUB PAS.TOUCHE
GOLONG SALUT.A.TOI


*PAS.OFF2
LC FB
?C‹B B
GOYES PAS.OFF3
D0= 80400
C=DAT0 A
D0=C
A=0 B
A=A+1 B
C=DAT0 B
?C=A B
GOYES PAS.OFF3
C=C-1 B
DAT0=C B
GOSUB PAS.TOUCHE
GOLONG SALUT.A.TOI


*PAS.OFF3
ST=0 0
GOSUB VSYNC
D0= 00120
LC 00880
A=R0 A
C=C+A A
DAT0=C A


*TEST.POUR.PAUSE.SOURIS
ST=0 7
GOSUB TOUCHE
C=R3 A
R1=C A
C=R4 A
R2=C A
?ST=0 7
GOYES RIEN.POUR.TOI
D0= 8040F
C=DAT0 A
LA 00005
?A=C A
GOYES OK.SOURIS.PAUSE
?C=0 A
GOYES RIEN.POUR.TOI
C=C-1 A
DAT0=C A
GOSUB VSYNC
GOTO UN.PIXEL


*OK.SOURIS.PAUSE
C=C-1 A
DAT0=C A
GOSUB VSYNC
GOTO UN.PIXEL


*RIEN.POUR.TOI
LC 002
GOSBVL 01EEC
?CBIT=0 5
GOYES TROIS.PIXEL
GOSUB KEY
GOSUB KEY


*TROIS.PIXEL
GOSUB KEY
GOSUB KEY
GOSUB VSYNC
GOSUB KEY


*UN.PIXEL
GOSUB KEY


*PAUSE.SOURIS
?ST=1 7
GOYES SOURIS.OK
D0= 8040F
LC 00005
DAT0=C A
D0= 80414
C=DAT0 A
C=C-1 A
DAT0=C A
?C‹0 A
GOYES PAS.SUSPENSION
D0= 80414
LC 005A0
DAT0=C A
GOLONG NON4


*SOURIS.OK
D0= 80414
LC 005A0
DAT0=C A


*PAS.SUSPENSION
GOSUB VSYNC
GOSBVL 42359
GOTO BOUCLE


*KEY
ST=0 7
GOSUB TOUCHE
?ST=0 7
RTNYES%
%_____________________
GOSUB AFFICHE
C=R1 A
R3=C A
C=R2 A
R4=C A
GOSUB AFFICHE
RTN%
%_____________________


*TOUCHE
LC 040
GOSBVL 01EEC
?CBIT=0 2
GOYES PAS.GAUCHE
ST=1 7
A=R1 A
A=A-1 A
?A=0 A
GOYES PAS.GAUCHE
R1=A A


*PAS.GAUCHE
LC 040
GOSBVL 01EEC
?CBIT=0 0
GOYES PAS.DROITE
ST=1 7
A=R1 A
A=A+1 A
LC 0007F
?A=C A
GOYES PAS.DROITE
R1=A A


*PAS.DROITE
LC 080
GOSBVL 01EEC
?CBIT=0 1
GOYES PAS.HAUT
ST=1 7
A=R2 A
A=A-1 A
?A=0 A
GOYES PAS.HAUT
R2=A A


*PAS.HAUT
LC 040
GOSBVL 01EEC
?CBIT=0 1
GOYES PAS.BAS
ST=1 7
A=R2 A
A=A+1 A
LC 00038
?A=C A
GOYES PAS.BAS
R2=A A


*PAS.BAS
RTN%
%_____________________


*AFFICHE
C=R4 W
C=C+C A
B=C A
CSL A
C=C+B A
A=R3 W
B=A P
ASRB A
ASRB A
A=A+C A
C=R0 A
A=A+C A
D0=A
LC 3
C=C&B P
P=C 0
C=P 15
P= 0
?ST=0 5
GOYES TARGET.NORMAL
GOSUB APRES.T2
/TARGET2


*APRES.T2
C=RSTK
GOTO PETIT.SAUT


*TARGET.NORMAL
GOSUB APRES.T
/TARGET


*APRES.T
C=RSTK


*PETIT.SAUT
D1=C
LC 07
D=C B


*BOUCLE.AFFICHE
A=0 A
A=DAT1 1
B=C S
B=B-1 S
GOC FIN.BOUCLE
A=A+A A
B=B-1 S
GOC FIN.BOUCLE
A=A+A A
B=B-1 S
GOC FIN.BOUCLE
A=A+A A


*FIN.BOUCLE
C=DAT0 A
B=C A
C=C!A A
B=B&A A
C=C-B A
DAT0=C A
B=A A
AD0EX
LC 00880
C=C+A A
D0=C
A=B A
C=DAT0 A
B=C A
C=C!A A
B=B&A A
C=C-B A
DAT0=C A
B=A A
AD0EX
LC 00880
A=A-C A
D0=A
A=B A
D1=D1+ 2
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
D=D-1 B
GONC BOUCLE.AFFICHE
RTN%
%_____________________


*VSYNC
D1= 00128
C=DAT1 B
CBIT=0 6
CBIT=0 7
?C=0 B
GOYES VSYNC


*VSYNC2
C=DAT1 B
CBIT=0 6
CBIT=0 7
?C‹0 B
GOYES VSYNC2
D1= 8068D
RTN%
%_____________________


*PAS.TOUCHE
D0= 00120
C=R0 A
DAT0=C A
GOSUB VSYNC
D0= 00120
LC 00880
A=R0 A
C=C+A A
DAT0=C A
LC 010
GOSBVL 01EEC
?CBIT=0 4
RTNYES%
%_____________________
GOSUB VSYNC
GOSUB VSYNC
GOTO PAS.TOUCHE


*ICONE
GOSUB AFFICHE
GOSUB APRES.BOX
/MOZBOX


*APRES.BOX
C=RSTK
D0=C
A=R0 A
C=0 A
LC 2AF
A=A+C A
B=A A
D1=A
GOSUB BCL.AFF.BOXMOZ
A=B A
LC 00880
C=C+A A
D1=C
GOSUB BCL.AFF.BOXMOZ
GOSUB AFFICHE
GOTO SUITE.BOXMOZ


*BCL.AFF.BOXMOZ
D=0 A
LC 21
D=D+C B


*AFF.LIGNES
C=DAT0 16
DAT1=C 16
D0=D0+ 16
D1=D1+ 16
C=DAT0 2
DAT1=C 2
D1=D1+ 4
D0=D0+ 2
D1=D1+ 14
D=D-1 B
GONC AFF.LIGNES
ST=1 2
RTN%
%_____________________


*SUITE.BOXMOZ
GOSUB ROUT.AFF
A=R1 A
C=0 A
LC 1A
?CŠA A
GOYES FIN.TEST
LC 28
?C‰A A
GOYES FIN.TEST
A=R2 A
LC 11
?CŠA A
GOYES FIN.TEST
LC 1F
?C‰A A
GOYES FIN.TEST
GOSUB PAS.TOUCHE
GOLONG SALUT.A.TOI


*FIN.TEST
A=R1 A
C=0 A
LC 50
?CŠA A
GOYES FIN.TEST2
LC 5B
?C‰A A
GOYES FIN.TEST2
A=R2 A
LC 1F
?CŠA A
GOYES FIN.TEST2
LC 27
?C‰A A
GOYES FIN.TEST2
D0= 8040A
C=DAT0 A
LA 00B40
?CŠA A
GOYES FIN.TEST2
LA 00050
C=C+A A
DAT0=C A
GOSUB ROUT.AFF
GOSUB PAS.TOUCHE
GOLONG PAS.DROP


*FIN.TEST2
A=R1 A
C=0 A
LC 50
?CŠA A
GOYES FIN.TEST3
LC 5B
?C‰A A
GOYES FIN.TEST3
A=R2 A
LC 29
?CŠA A
GOYES FIN.TEST3
LC 33
?C‰A A
GOYES FIN.TEST3
D0= 8040A
C=DAT0 A
?C=0 A
GOYES FIN.TEST3
LA 00050
C=C-A A
DAT0=C A
GOSUB ROUT.AFF
GOSUB PAS.TOUCHE
GOLONG PAS.DROP


*FIN.TEST3
A=R1 A
C=0 A
LC 3B
?CŠA A
GOYES FIN.TEST4
LC 4A
?C‰A A
GOYES FIN.TEST4
A=R2 A
LC 23
?CŠA A
GOYES FIN.TEST4
LC 2D
?C‰A A
GOYES FIN.TEST4
GOTO FIN.NUMERO2


*FIN.TEST4
GOSUB PAS.TOUCHE
GOLONG PAS.DROP


*FIN.NUMERO2
GOSUBL PAS.TOUCHE
C=0 A
LC 9
GOSBVL 05B7D
GOSUBL PATH
C=R0 A
C=C+10 A
D0=C
DAT0=A B
D0=D0+ 2
D1= 80400
LA 00203
C=DAT1 A
C=C+A A
D1=C
C=DAT1 B
C=C+1 B
DAT0=C B
D0=D0+ 2
D1= 8040A
C=DAT1 A
DAT0=C A


*BYE.BYE
GOSBVL 01C7F
GOSBVL 067D2
GOSBVL 010E5
A=R0 A
DAT1=A A
GOSBVL 2D564


*ROUT.AFF
GOSUBL AFFICHE
D1= 80405
C=DAT1 A
D1= 8040A
A=DAT1 A
C=C+A A
D1=C
C=R0 A
LA 0048D
C=C+A A
D0=C
GOSUB AFF.I.BOX
C=R0 A
LA 0048D
C=C+A A
LA 00880
C=C+A A
D0=C
GOSUB AFF.I.BOX
GOSUBL AFFICHE
RTN%
%_____________________


*AFF.I.BOX
LA 9


*BCL1.BOX
C=DAT1 4
DAT0=C 4
D1=D1+ 4
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
A=A-1 P
GONC BCL1.BOX
RTN%
%_____________________


*AFF.SPRITE
C=DAT1 WP
DAT0=C WP
CD1EX
C+P+1
D1=C
D0=D0+ 16
D0=D0+ 16
D0=D0+ 2
A=A-1 B
GONC AFF.SPRITE
P= 0
RTN%
%_____________________


*OPTION
GOSUBL AFFICHE
GOSUB APRES.FENETRE
/FENETRE


*APRES.FENETRE
C=RSTK
D1=C
C=R0 A
LA 00220
C=C+A A
D0=C
LA 20
P= 7
GOSUB AFF.SPRITE
C=R0 A
LA 00220
C=C+A A
LA 00880
C=C+A A
D0=C
LA 20
P= 7
GOSUB AFF.SPRITE
GOSUBL AFFICHE
ST=1 3
GOSUBL PAS.TOUCHE
RTN%
%_____________________


*FIN.OPTION
GOSUBL PAS.TOUCHE
GOLONG SALUT.A.TOI


*SUITE.OPTION
C=R2 A
LA 0F
?C‰A B
GOYES FIN.OPTION
LA 30
?CŠA B
GOYES FIN.OPTION
C=R1 A
LA 1C
?CŠA B
GOYES FIN.OPTION
%TEST.SI.NEW.ICONE
C=R2 A
LA 16
?CŠA B
GOYES NON
D0= 8040A
C=0 A
DAT0=C A
GOSUBL ICONE


*NON
LA 1D
?CŠA B
GOYES NON2
D0= 00101
C=DAT0 2
LA 18
?CŠA B
GOYES PAS.C+
C=C+1 B
DAT0=C 2


*PAS.C+
GOSUBL PAS.TOUCHE
GOLONG PAS.DROP


*NON2
C=R2 A
LA 24
?CŠA B
GOYES NON3
D0= 00101
C=DAT0 2
A=0 B
A=A+8 B
?C‰A B
GOYES PAS.C-
C=C-1 B
DAT0=C 2


*PAS.C-
GOSUBL PAS.TOUCHE
GOLONG PAS.DROP


*NON3
%ON TEST SI SUPPRIMER
C=R2 A
LA 2B
?C<A B
GOYES SAUT.A.LA.CON
GOTO NON4


*SAUT.A.LA.CON
GOSUBL AFFICHE
GOSUB AP.FEN.SUP
/FENETRE.SUPPRIMER


*AP.FEN.SUP
C=RSTK
D0=C
A=R0 A
C=0 A
LC 314
A=A+C A
B=A A
D1=A
GOSUB BCL.AFF.SUPP
A=B A
LC 00880
C=C+A A
D1=C
GOSUB BCL.AFF.SUPP
GOSUBL PAS.TOUCHE
GOSUBL AFFICHE
GOSUB SI.TOUCHE
ST=1 4
GOTO FIN.OPTION


*NON4
ST=1 0
GOSBVL 7026C
ST=0 0
GOLONG BOUCLE


*GO.TO.ICONE
D=C A
D=D-2 A
GOSUBL PATH
B=A A
LA 00205
CD0EX
C=C+A A
D0=C
LA 0006C


*BCL.GO.TO
C=DAT0 B
?C‹B B
GOYES CONT.GO.TO
D=D-1 B
GONC CONT.GO.TO
RTN%
%_____________________


*CONT.GO.TO
CD0EX
C=C+A A
D0=C
GOTO BCL.GO.TO


*REPERTOIRE
?ST=1 0
GOYES OK.R
GOLONG PAS.DROP


*OK.R
B=C A
D0= 80400
A=DAT0 A
D0=A
A=0 A
A=DAT0 B
C=A B
C=C+1 B
DAT0=C B
CD0EX
A=A+A A
A=A+C A
A=A+2 A
D0=A
C=B A
DAT0=C B
GOSUBL PAS.TOUCHE
GOLONG SALUT.A.TOI


*BCL.AFF.SUPP
D=0 A
LC 12
D=D+C B


*AFF.LIGNES2
C=DAT0 16
DAT1=C 16
D0=D0+ 16
D1=D1+ 16
C=DAT0 4
DAT1=C 4
D1=D1+ 4
D0=D0+ 4
D1=D1+ 14
D=D-1 B
GONC AFF.LIGNES2
RTN%
%_____________________


*SI.TOUCHE
ST=1 6
ST=0 0
GOLONG BOUCLE


*FIN.ATTENTE
ST=0 6
RTN%
%_____________________


*TEST.SI.REP.VIDE
B=C A
D0= 80400
C=DAT0 A
LA 00200
C=C+A A
D0=C
C=DAT0 X
C=C-1 X
D0=D0+ 5


*BCL.TEST.REP
A=DAT0 B
?A=B B
RTNYES%
%_____________________
D1=C
CD0EX
LA 0006C
C=C+A A
D0=C
CD1EX
C=C-1 X
GONC BCL.TEST.REP
RTN%
%_____________________


*ROUT.NUMERO.LISTE
D0= 80400
C=DAT0 A
LA 00200
C=C+A A
D0=C
C=DAT0 A
C=C-1 X
B=C A
CD0EX
A=0 A
LA 6E
C=C+A A
D0=C
C=B A
A=R1 A
B=A A


*BCL.ROUT.NUMERO
A=DAT0 X
?A>B X
GOYES SUITE.NUMERO
A=A-1 X
DAT0=A X


*SUITE.NUMERO
D1=C
CD0EX
LA 0006C
C=C+A A
D0=C
CD1EX
C=C-1 X
GONC BCL.ROUT.NUMERO
RTN%
%_____________________
@